[gd_scene load_steps=41 format=3 uid="uid://dftdwyx4b8j6x"]

[ext_resource type="PackedScene" uid="uid://buhkop20hskr1" path="res://Models/Smiling Sammy.glb" id="1_vao3v"]
[ext_resource type="Script" path="res://Scripts/CSharp/SmilingSammy.cs" id="2_kl1vx"]
[ext_resource type="Script" path="res://Scripts/CSharp/SammyRay.cs" id="3_tptdi"]

[sub_resource type="Animation" id="Animation_uyurx"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(-5.96046e-08, 0, 0)]
}

[sub_resource type="Animation" id="Animation_k6jkp"]
resource_name = "SwingRay"
length = 0.5
loop_mode = 1
step = 0.01
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:rotation")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.25, 0.5),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0, 1.0472, 0), Vector3(0, -1.0472, 0), Vector3(0, 1.0472, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_kbh4k"]
_data = {
"RESET": SubResource("Animation_uyurx"),
"SwingRay": SubResource("Animation_k6jkp")
}

[sub_resource type="BoxShape3D" id="BoxShape3D_xj1yg"]
size = Vector3(0.3, 2, 0.3)

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_khrga"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_d3giw"]
animation = &"Jumpscare1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_co1al"]
animation = &"Jumpscare2"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_b2igo"]
animation = &"Run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_etes2"]
animation = &"Default-fail"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_cuxt1"]
animation = &"Stun"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_oyfea"]
animation = &"StunEnd"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0vfgt"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bddou"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_a5b2m"]
advance_mode = 2
advance_condition = &"stunEnded"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_53jma"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_p41yc"]
states/Default-fail/node = SubResource("AnimationNodeAnimation_etes2")
states/Default-fail/position = Vector2(361, 100)
states/Stun/node = SubResource("AnimationNodeAnimation_cuxt1")
states/Stun/position = Vector2(526, 100)
states/StunEnd/node = SubResource("AnimationNodeAnimation_oyfea")
states/StunEnd/position = Vector2(702, 100)
transitions = ["Start", "Default-fail", SubResource("AnimationNodeStateMachineTransition_0vfgt"), "Default-fail", "Stun", SubResource("AnimationNodeStateMachineTransition_bddou"), "Stun", "StunEnd", SubResource("AnimationNodeStateMachineTransition_a5b2m"), "StunEnd", "End", SubResource("AnimationNodeStateMachineTransition_53jma")]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_8aqb2"]
animation = &"Walk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_a0m1v"]
xfade_time = 0.2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_s77oy"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"notIdle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0sp88"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"playerSpotted"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_kg15p"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"playerSpotted"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ddp86"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_cqo5m"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xbvtb"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"notIdle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_boxv6"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"gotStunned"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7cviy"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"gotStunned"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xs4da"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"gotStunned"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_g5xm6"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ltwx2"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"playerCaught1"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ovmpo"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"playerCaught2"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_lylx8"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"playerCaught1"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_dch4q"]
advance_mode = 2
advance_condition = &"playerCaught2"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_stgtg"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"playerCaught1"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xaebk"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"playerCaught2"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yd0gs"]
xfade_time = 0.1
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_trua1"]
xfade_time = 0.1
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_8hr1p"]
states/Idle/node = SubResource("AnimationNodeAnimation_khrga")
states/Idle/position = Vector2(357, 100)
states/Jumpscare1/node = SubResource("AnimationNodeAnimation_d3giw")
states/Jumpscare1/position = Vector2(679, 36)
states/Jumpscare2/node = SubResource("AnimationNodeAnimation_co1al")
states/Jumpscare2/position = Vector2(684, 166)
states/Run/node = SubResource("AnimationNodeAnimation_b2igo")
states/Run/position = Vector2(492, 166)
"states/Stun State/node" = SubResource("AnimationNodeStateMachine_p41yc")
"states/Stun State/position" = Vector2(684, 100)
states/Walk/node = SubResource("AnimationNodeAnimation_8aqb2")
states/Walk/position = Vector2(492, 36)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_a0m1v"), "Idle", "Walk", SubResource("AnimationNodeStateMachineTransition_s77oy"), "Idle", "Run", SubResource("AnimationNodeStateMachineTransition_0sp88"), "Walk", "Run", SubResource("AnimationNodeStateMachineTransition_kg15p"), "Run", "Idle", SubResource("AnimationNodeStateMachineTransition_ddp86"), "Walk", "Idle", SubResource("AnimationNodeStateMachineTransition_cqo5m"), "Run", "Walk", SubResource("AnimationNodeStateMachineTransition_xbvtb"), "Walk", "Stun State", SubResource("AnimationNodeStateMachineTransition_boxv6"), "Run", "Stun State", SubResource("AnimationNodeStateMachineTransition_7cviy"), "Idle", "Stun State", SubResource("AnimationNodeStateMachineTransition_xs4da"), "Stun State", "Idle", SubResource("AnimationNodeStateMachineTransition_g5xm6"), "Walk", "Jumpscare1", SubResource("AnimationNodeStateMachineTransition_ltwx2"), "Walk", "Jumpscare2", SubResource("AnimationNodeStateMachineTransition_ovmpo"), "Run", "Jumpscare1", SubResource("AnimationNodeStateMachineTransition_lylx8"), "Run", "Jumpscare2", SubResource("AnimationNodeStateMachineTransition_dch4q"), "Idle", "Jumpscare1", SubResource("AnimationNodeStateMachineTransition_stgtg"), "Idle", "Jumpscare2", SubResource("AnimationNodeStateMachineTransition_xaebk"), "Jumpscare1", "Idle", SubResource("AnimationNodeStateMachineTransition_yd0gs"), "Jumpscare2", "Idle", SubResource("AnimationNodeStateMachineTransition_trua1")]
graph_offset = Vector2(98, -37)

[node name="SmilingSammy" node_paths=PackedStringArray("sammyNav", "head", "sammyTimer", "sammyAnimTree") groups=["Monster"] instance=ExtResource("1_vao3v")]
editor_description = "Smiling Sammy, the main antagonist of the game."
collision_layer = 16
collision_mask = 206
script = ExtResource("2_kl1vx")
sammyNav = NodePath("SammyNav")
head = NodePath("Smiling Sammy2/Skeleton3D/Head")
sammyTimer = NodePath("SammyTimer")
sammyAnimTree = NodePath("SammyTree")

[node name="Smiling Sammy2" parent="." index="0"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="Smiling Sammy2" index="0"]
bones/0/position = Vector3(1.17992e-09, 0.964587, -0.0552)
bones/0/rotation = Quaternion(0.0824272, 5.14041e-08, 8.81262e-09, 0.996597)
bones/1/rotation = Quaternion(-0.0635417, -2.97448e-08, -4.77601e-09, 0.997979)
bones/2/rotation = Quaternion(0.00896678, 4.67013e-08, -1.12303e-08, 0.99996)
bones/3/rotation = Quaternion(0.198028, 1.24735e-08, 1.75769e-09, 0.980196)
bones/4/rotation = Quaternion(-0.0258928, 4.32462e-08, -5.18614e-09, 0.999665)
bones/5/rotation = Quaternion(-0.0959855, -5.98329e-09, -2.28084e-08, 0.995383)
bones/6/rotation = Quaternion(-0.0601687, 0.401392, -0.0618147, 0.911835)
bones/7/rotation = Quaternion(0.798436, 1.98634e-07, 4.56759e-07, 0.60208)
bones/10/rotation = Quaternion(-0.631892, -0.0351285, -0.282489, 0.720887)
bones/11/rotation = Quaternion(-0.0969204, -0.0189644, -0.256819, 0.961401)
bones/12/rotation = Quaternion(-5.81809e-09, 0.231441, -9.85722e-09, 0.972849)
bones/13/rotation = Quaternion(-0.273945, -4.5546e-08, 5.11073e-08, 0.961745)
bones/14/rotation = Quaternion(-0.0871554, -8.53085e-05, 0.000975239, 0.996194)
bones/15/rotation = Quaternion(-0.130526, 0.000228997, -0.0017395, 0.991443)
bones/16/position = Vector3(-0.0180001, 0.11, -1.0674e-05)
bones/16/rotation = Quaternion(-0.0871555, -8.52934e-05, 0.00097522, 0.996194)
bones/17/rotation = Quaternion(-0.130526, 0.000229009, -0.00173949, 0.991443)
bones/18/rotation = Quaternion(-0.0871555, -8.52934e-05, 0.00097522, 0.996194)
bones/19/rotation = Quaternion(-0.130526, 0.000229019, -0.00173947, 0.991443)
bones/20/rotation = Quaternion(-0.0871554, -8.53083e-05, 0.000975233, 0.996194)
bones/21/rotation = Quaternion(-0.130526, 0.000229008, -0.00173949, 0.991443)
bones/22/rotation = Quaternion(-0.0327953, 0.0808166, -0.372131, 0.924073)
bones/23/rotation = Quaternion(-0.34202, 0.000600385, -0.0016494, 0.939691)
bones/25/rotation = Quaternion(-0.600222, 0.093051, 0.31783, 0.728052)
bones/26/rotation = Quaternion(-0.00914103, 0.0431322, 0.704379, 0.708454)
bones/27/rotation = Quaternion(8.77867e-08, -0.509547, -8.97467e-08, 0.860443)
bones/28/rotation = Quaternion(-0.273603, 1.30546e-08, -4.39688e-08, 0.961843)
bones/29/rotation = Quaternion(-0.0897661, 8.78547e-05, -0.00097502, 0.995962)
bones/30/rotation = Quaternion(-0.139356, -0.000244507, 0.00173738, 0.990241)
bones/31/position = Vector3(0.0180001, 0.11, -1.08532e-05)
bones/31/rotation = Quaternion(-0.0897661, 8.78628e-05, -0.000975018, 0.995962)
bones/32/rotation = Quaternion(-0.139356, -0.000244496, 0.00173741, 0.990241)
bones/33/rotation = Quaternion(-0.0897661, 8.78629e-05, -0.000975018, 0.995962)
bones/34/rotation = Quaternion(-0.139356, -0.000244494, 0.0017374, 0.990241)
bones/35/rotation = Quaternion(-0.0897661, 8.78547e-05, -0.000975019, 0.995962)
bones/36/rotation = Quaternion(-0.139356, -0.000244505, 0.00173738, 0.990241)
bones/37/rotation = Quaternion(-0.115654, -0.0235507, 0.27841, 0.953183)
bones/38/rotation = Quaternion(-0.34715, -0.000609385, 0.00164606, 0.937808)
bones/41/rotation = Quaternion(0.964095, 0.0118909, -0.149283, 0.219305)
bones/42/rotation = Quaternion(0.325796, 4.45078e-08, -1.45171e-08, 0.94544)
bones/43/rotation = Quaternion(-0.583612, -4.26712e-06, 0.000676457, 0.812032)
bones/44/rotation = Quaternion(-0.000184674, 0.933173, -0.359428, 0.000283925)
bones/45/rotation = Quaternion(0.964095, -0.011891, 0.149283, 0.219305)
bones/46/rotation = Quaternion(0.325796, 7.73078e-08, -1.46548e-08, 0.94544)
bones/47/rotation = Quaternion(-0.583612, 4.27082e-06, -0.000676584, 0.812032)
bones/48/rotation = Quaternion(0.000184685, 0.933173, -0.359428, -0.000283554)

[node name="Head" type="BoneAttachment3D" parent="Smiling Sammy2/Skeleton3D" index="1"]
transform = Transform3D(0.670127, 0.0644272, 0.739445, -0.00612463, 0.996672, -0.0812887, -0.742221, 0.049945, 0.668291, 2.42917e-08, 1.7315, 0.116213)
bone_name = "spine.006"
bone_idx = 6

[node name="SammyRay" type="RayCast3D" parent="Smiling Sammy2/Skeleton3D/Head" index="0" node_paths=PackedStringArray("rayAnim")]
transform = Transform3D(1, 0, 0, 0, 1, 5.96046e-08, 0, -5.96046e-08, 1, -6.47536e-08, 0.194275, 0.1663)
target_position = Vector3(0, 0, 5)
collision_mask = 206
script = ExtResource("3_tptdi")
rayAnim = NodePath("SammyRayAnim")

[node name="SammyRayAnim" type="AnimationPlayer" parent="Smiling Sammy2/Skeleton3D/Head/SammyRay" index="0"]
autoplay = "SwingRay"
libraries = {
"": SubResource("AnimationLibrary_kbh4k")
}

[node name="SammyCol" type="CollisionShape3D" parent="." index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("BoxShape3D_xj1yg")

[node name="SammyNav" type="NavigationAgent3D" parent="." index="3"]
path_desired_distance = 0.2
path_height_offset = 0.6
avoidance_enabled = true
debug_enabled = true
debug_use_custom = true
debug_path_custom_color = Color(1, 0, 0, 1)

[node name="SammyTimer" type="Timer" parent="." index="4"]
process_callback = 0
wait_time = 5.0
one_shot = true

[node name="SammyTree" type="AnimationTree" parent="." index="5"]
tree_root = SubResource("AnimationNodeStateMachine_8hr1p")
anim_player = NodePath("../AnimationPlayer")
active = true
parameters/conditions/gotStunned = false
parameters/conditions/idle = false
parameters/conditions/notIdle = false
parameters/conditions/playerCaught1 = false
parameters/conditions/playerCaught2 = false
parameters/conditions/playerSpotted = false
"parameters/Stun State/conditions/stunEnded" = false

[connection signal="timeout" from="SammyTimer" to="." method="Repath" flags=18]
